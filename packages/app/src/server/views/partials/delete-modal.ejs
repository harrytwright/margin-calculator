<!-- Delete Confirmation Modal -->
<div
  id="delete-modal"
  class="fixed inset-0 flex items-center justify-center hidden z-50"
>
  <div class="fixed inset-0 bg-black bg-opacity-50" id="delete-modal-overlay"></div>
  <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6 relative z-10">
    <h3 class="text-lg font-semibold text-gray-900 mb-2">Confirm Deletion</h3>
    <p class="text-gray-600 mb-6" id="delete-modal-message">
      Are you sure you want to delete this item? This action cannot be undone.
    </p>
    <div class="flex justify-end gap-3">
      <button
        onclick="closeDeleteModal()"
        class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200"
      >
        Cancel
      </button>
      <button
        id="confirm-delete-btn"
        class="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700"
      >
        Delete
      </button>
    </div>
  </div>
</div>

<script>
  function closeDeleteModal() {
    document.getElementById('delete-modal').classList.add('hidden');
  }

  function showDeleteModal(message, onConfirm) {
    document.getElementById('delete-modal-message').textContent = message;
    document.getElementById('delete-modal').classList.remove('hidden');

    const confirmBtn = document.getElementById('confirm-delete-btn');
    confirmBtn.onclick = () => {
      onConfirm();
      closeDeleteModal();
    };
  }

  function confirmDelete(entityType, slug, name) {
    const message = `Are you sure you want to delete "${name}"? This action cannot be undone.`;
    showDeleteModal(message, () => {
      // Perform DELETE request using fetch
      fetch(`/app/${entityType}s/${slug}`, {
        method: 'DELETE',
        headers: {
          'HX-Request': 'true'
        }
      })
        .then(response => response.text())
        .then(html => {
          // Update the list with the new HTML
          const listId = entityType === 'supplier' ? 'suppliers-list' :
                         entityType === 'ingredient' ? 'ingredients-list' :
                         'recipes-list';
          const listElement = document.getElementById(listId);
          if (listElement) {
            listElement.innerHTML = html;
          }
          showToast(`${entityType.charAt(0).toUpperCase() + entityType.slice(1)} deleted successfully`, 'success');
        })
        .catch(error => {
          console.error('Delete error:', error);
          showToast('Failed to delete item', 'error');
        });
    });
  }
</script>
